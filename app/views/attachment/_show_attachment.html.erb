<div class="modal inmodal col-lg-12" id="show-attachment-modal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">附件管理</h4>
      </div>
      <div class="modal-body">
        <!-- 附件内容块 -->
        <% attachment_class_str = (0...16).map {(65 + rand(26)).chr}.join %>
        <div class="<%= attachment_class_str %>"></div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function () {
    var $showAttachmentModal = $("#show-attachment-modal");

    $showAttachmentModal.on("show.bs.modal", function (event) {
      var current_link = $(event.relatedTarget);

      var attachmentOption = {
        service_name: current_link.data("service-name"),
        attachment_type: current_link.data("attachment-type"),
        attachment_id: current_link.data("attachment-id"),
        object_name: current_link.data("object-name"),
        object_id: current_link.data("object-id"),
        attachment: current_link.data("attachment"),
        attachment_name: current_link.data("attachment-name"),
        object_locked: current_link.data("object-locked"),
        is_custom_text: current_link.data("is-custom-text")
      };
      $showAttachmentModal.find('.<%= attachment_class_str %>').uploadAttachment(attachmentOption);
    });
  });
</script>
